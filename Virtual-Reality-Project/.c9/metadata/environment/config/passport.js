{"filter":false,"title":"passport.js","tooltip":"/config/passport.js","undoManager":{"mark":3,"position":3,"stack":[[{"start":{"row":0,"column":0},"end":{"row":33,"column":0},"action":"insert","lines":["const JwtStrategy = require(\"passport-jwt\").Strategy; ","const ExtractJwt = require(\"passport-jwt\").ExtractJwt;","const mongoose = require(\"mongoose\");","","require('../models/user.model'); ","const User = mongoose.model(\"User\");","","const keys = process.env.ATLAS_URI;","","","const opts = {};","opts.jwtFromRequest = ExtractJwt.fromAuthHeaderAsBearerToken('JWT');","opts.secretOrKey = 'secret'; ","","","module.exports = passport => {","  passport.use(","    ","    new JwtStrategy(opts, (jwt_payload, done) => {","","","      User.findById(jwt_payload.id)","        .then(user => {","          if (user) {","            return done(null, user);","          }","          return done(null, false);","        })","        .catch(err => console.log(err));","    })","  );","};","",""],"id":1}],[{"start":{"row":7,"column":13},"end":{"row":7,"column":35},"action":"remove","lines":["process.env.ATLAS_URI;"],"id":2},{"start":{"row":7,"column":13},"end":{"row":7,"column":66},"action":"insert","lines":["'mongodb://Alex:Turtle52@18.232.32.128/entertainment'"]}],[{"start":{"row":7,"column":66},"end":{"row":7,"column":67},"action":"insert","lines":[";"],"id":3}],[{"start":{"row":7,"column":67},"end":{"row":7,"column":68},"action":"insert","lines":[" "],"id":4}]]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":14,"column":0},"end":{"row":14,"column":0},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":43,"mode":"ace/mode/javascript"}},"timestamp":1619916972631,"hash":"9ae5284b1e7a491217272fb7ba006783c3833b92"}